@model IEnumerable<MyPortal.Models.Database.Student>
@{
    ViewBag.Title = "Students";
    Layout = "~/Views/Shared/_LayoutStaff.cshtml";
}

<!--#region Title-->
<div class="container float-left">
    <h2 class="mp-page-title">Students</h2>
    <hr/>
</div>
<!--#endregion-->
<!--#region Buttons at Top of Page-->
<div class="container float-left">
    @if (User.IsInRole("SeniorStaff"))
    {
        @Html.ActionLink("New Student", "NewStudent", "Staff", null, new {@class = "btn btn-success"})
        <hr/>
    }
</div>

<div class="float-left container">
    @Html.EJS().Grid("Students").DataSource(dataManager =>
    {
        dataManager.Url("/api/people/students/get/all").CrossDomain(false).Adaptor("WebApiAdaptor"); 

    }).Columns(col =>
    {
        col.Field("DisplayName").HeaderText("Name").Width("120").Add();
        col.Field("YearGroupName").HeaderText("Year Group").Width("120").Add();
        col.Field("RegGroupName").HeaderText("Reg Group").Width("120").Add();
    }).AllowPaging().Load("load").Render()
</div>

@section scripts
{
    <script>
        $(document).ready(function() {
        });

        function load() {
            var grid = document.getElementById('Students').ej2_instances[0];
            var rowHeight = grid.getRowHeight();  //height of the each row
            var gridHeight = grid.height;  //grid height
            var pageSize = grid.pageSettings.pageSize;   //initial page size
            var pageResize = (gridHeight - (pageSize * rowHeight)) / rowHeight; //new page size is obtained here
            grid.pageSettings.pageSize = 15;
        }
    </script>

    @Scripts.Render("~/bundles/staff")
}